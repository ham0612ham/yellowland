<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="assigncomm">
	<insert id="insertComm" parameterType="com.sp.app.assigncomm.Community">
		INSERT INTO assignComm(num, subject, content, userId, dongNum, regDate, updateDate, thumnail, zip, addr1, addr2) 
			VALUES(ASSIGNCOMM_SEQ.NEXTVAL, #{subject}, #{content}, #{id}, #{dongNum}, 
				SYSDATE, NULL, #{thumnail}, #{zip}, #{addr1}, #{addr2})
	</insert>
	
	<insert id="insertCommImg" parameterType="com.sp.app.assigncomm.Community">
		INSERT INTO assignCommImg(imgNum, num, imgName) 
			VALUES(assignCommImg_seq.NEXTVAL, #{num}, #{imgName}) 
	</insert>
	
	<update id="updateComm" parameterType="com.sp.app.assigncomm.Community">
		UPDATE assignComm SET subject=#{subject}, content=#{content}, updateDate=SYSDATE, 
			thumnail=#{thumnail}, zip=#{zip}, addr1=#{addr1}, addr2=#{addr2}
		WHERE num=#{num}
	</update>
	
	<update id="updateCommImg" parameterType="com.sp.app.assigncomm.Community">
		UPDATE assignCommImg SET imgName=#{imgName}
			WHERE imgNum=#{num}
	</update>
	
	<delete id="deleteComm" parameterType="long">
		DELETE FROM assignComm 
			WHERE num=#{num}
	</delete>
	
	<select id="readComm" parameterType="long" resultType="com.sp.app.assigncomm.Community">
		SELECT a.num, subject, content, userId, dongNum, regDate, updateDate, thumnail, zip, addr1, addr2, imgName
		FROM assignComm a
		LEFT OUTER JOIN assignCommImg ai ON a.num = ai.num
		WHERE num = #{num}
	</select>
	
	<select id="listComm" resultType="com.sp.app.assigncomm.Community">
		SELECT a.num, subject, content, userId, dongNum, regDate, updateDate, thumnail, zip, addr1, addr2, imgName
		FROM assignComm a
		LEFT OUTER JOIN assignCommImg ai ON a.num = ai.num
	</select>
</mapper>